import{a as me,b as N,c as ce,d as D,e as H,f as de,g as ue,h as b}from"./chunk-JRKHXA4F.js";import{a as fe}from"./chunk-H5O2VQJR.js";import{a as xe}from"./chunk-MPSJ6DIU.js";import{$ as te,$b as le,Ca as ie,Ha as v,J as X,Ja as f,Ka as w,M as ee,Ma as x,Na as B,Oa as ne,Pa as T,Qa as k,Ra as n,S as R,Sa as a,Ta as h,Ub as re,W as _,Wa as P,Wb as oe,Xa as y,Ya as d,ac as se,bc as Z,cb as Q,cc as pe,da as j,db as G,dc as ve,ea as A,eb as K,ec as V,fa as L,fb as l,fc as E,gb as s,gc as C,hb as M,hc as q,ic as he,jc as z,lb as S,mb as J,qb as p,rb as m,sb as Y,ua as o,va as g,zb as ae}from"./chunk-HUWQSKRG.js";function Fe(e,c){if(e&1&&(n(0,"td",5),l(1),a(),n(2,"td",5),l(3),a()),e&2){let t=d().$implicit,i=d();o(),s(t),o(2),s(i.expenses==null?null:i.expenses.get(t))}}function Ae(e,c){if(e&1&&(n(0,"td"),l(1),a(),n(2,"td"),l(3),a()),e&2){let t=d().$implicit,i=d();o(),s(t),o(2),s(i.expenses==null?null:i.expenses.get(t))}}function Le(e,c){if(e&1&&(n(0,"tr"),v(1,Fe,4,2)(2,Ae,4,2),a()),e&2){let t=c.$index,i=c.$count;o(),x(t===i-1?1:2)}}var _e=(()=>{class e{summary;expenses;showSpendings=!1;ngOnChanges(t){if(t.summary&&this.summary?.expenses){this.expenses=new Map(Object.entries(this.summary.expenses));let i=0;for(let r of this.expenses?.values())i+=r;this.expenses.set("Total",i)}}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=_({type:e,selectors:[["app-summary-table"]],inputs:{summary:"summary"},standalone:!0,features:[j,S],decls:55,vars:32,consts:[[1,"container","is-max-tablet"],[1,"is-flex","is-justify-content-center","is-size-7-mobile"],[1,"table","m-0","p-0"],[1,"has-text-centered"],[3,"click"],[1,"has-text-weight-bold"],[1,"has-text-danger","has-text-centered"],[1,"tags","has-addons","is-justify-content-center","mt-4"],[1,"tag","is-warning","has-text-weight-bold","is-size-6","is-size-7-mobile"],[1,"tag","is-info","has-text-weight-bold","is-size-6","is-size-7-mobile"],[3,"close","active"],[1,"table","is-size-7"],["colspan","2",1,"has-text-centered"]],template:function(i,r){i&1&&(n(0,"div",0)(1,"div",1)(2,"table",2)(3,"tr")(4,"th"),l(5),p(6,"translate"),a(),n(7,"td",3),l(8),a()(),n(9,"tr",4),y("click",function(){return r.showSpendings=!0}),n(10,"th"),l(11),p(12,"translate"),a(),n(13,"td",3)(14,"a",5),l(15),a()()(),n(16,"tr")(17,"th"),l(18),p(19,"translate"),a(),n(20,"td",3),l(21),a()()(),n(22,"table",2)(23,"tr")(24,"th"),l(25),p(26,"translate"),a(),n(27,"td",3),l(28),a()(),n(29,"tr")(30,"th"),l(31),p(32,"translate"),a(),n(33,"td",3),l(34),a()(),n(35,"tr")(36,"th"),l(37),p(38,"translate"),a(),n(39,"td",6),l(40),a()()()(),n(41,"div",7)(42,"span",8),l(43),p(44,"translate"),a(),n(45,"span",9),l(46),a()()(),n(47,"app-modal",10),y("close",function(){return r.showSpendings=!1}),n(48,"table",11)(49,"tr")(50,"th",12),l(51),p(52,"translate"),a()(),T(53,Le,3,1,"tr",null,B),a()()),i&2&&(o(5),s(m(6,16,"Total revenue")),o(3),s(r.summary==null?null:r.summary.totalRevenue),o(3),s(m(12,18,"Total spendings")),o(4),s(r.expenses==null?null:r.expenses.get("Total")),o(3),M("",m(19,20,"Cash")," "),o(3),s(r.summary==null?null:r.summary.totalCash),o(4),s(m(26,22,"Total receipts")),o(3),s(r.summary==null?null:r.summary.totalReceipts),o(3),s(m(32,24,"Free haircuts")),o(3),s(r.summary==null?null:r.summary.freeHaircuts),o(3),M("",m(38,26,"Not assigned receipts")," "),o(3),s(r.summary==null?null:r.summary.notAssignedTransactions),o(3),s(m(44,28,"Net revenue")),o(3),s(r.summary==null?null:r.summary.netRevenue),o(),f("active",r.showSpendings),o(4),s(m(52,30,"Total spendings")),o(2),k(r.expenses==null?null:r.expenses.keys()))},dependencies:[C,E,xe]})}return e})();function Be(e,c){e&1&&(n(0,"tr",7)(1,"th",6),l(2),p(3,"translate"),a(),n(4,"th",6),l(5),p(6,"translate"),a(),n(7,"th",6),l(8),p(9,"translate"),a(),n(10,"th",6),l(11),p(12,"translate"),a(),n(13,"th",6),l(14),p(15,"translate"),a(),n(16,"th",9),l(17),p(18,"translate"),a()()),e&2&&(o(2),s(m(3,6,"Name")),o(3),s(m(6,8,"Receipts")),o(3),s(m(9,10,"Gross")),o(3),s(m(12,12,"Free Cuts")),o(3),s(m(15,14,"Salary")),o(3),s(m(18,16,"Balance")))}function Re(e,c){if(e&1&&(v(0,Be,19,18,"tr",7),n(1,"tr")(2,"td"),l(3),a(),n(4,"td"),l(5),a(),n(6,"td"),l(7),a(),n(8,"td"),l(9),a(),n(10,"td"),l(11),a(),n(12,"td",8),l(13),a()()),e&2){let t=c.$implicit,i=c.$index,r=d();x(i===0?0:-1),o(3),s(t.name),o(2),s(t.receipts),o(2),s(t.grossRev),o(2),s(t.freeHaircuts),o(2),s(t.salary),o(2),s(r.balances==null?null:r.balances.get(t.name))}}function Pe(e,c){e&1&&(n(0,"tr")(1,"td"),l(2),p(3,"translate"),a()()),e&2&&(o(2),s(m(3,1,"Users summary not available")))}function Oe(e,c){}function $e(e,c){if(e&1&&(n(0,"td",10),l(1),p(2,"date"),a()),e&2){let t=d(2).$implicit,i=d().$implicit,r=d();f("rowSpan",r.rowSpan.get(i)),o(),s(Y(2,2,t.date,"MMM d"))}}function je(e,c){if(e&1&&v(0,$e,3,5,"td",10),e&2){let t=d().$index;x(t==0?0:-1)}}function Ne(e,c){if(e&1&&(n(0,"td"),l(1),p(2,"date"),a()),e&2){let t=d().$implicit;o(),s(Y(2,1,t.date,"MMM d"))}}function De(e,c){if(e&1&&(n(0,"tr"),v(1,je,1,1)(2,Ne,3,4,"td"),n(3,"td"),l(4),a(),n(5,"td"),l(6),a(),n(7,"td"),l(8),a(),n(9,"td"),l(10),a(),n(11,"td"),l(12),a(),n(13,"td"),l(14),a()()),e&2){let t=c.$implicit,i=d().$implicit,r=d();o(),x(r.rowSpan.get(i)?1:2),o(3),s(t.name),o(2),s(t.receipts),o(2),s(t.grossRev),o(2),s(t.freeHaircuts),o(2),s(t.salary),o(2),s(t.paid)}}function He(e,c){if(e&1&&(v(0,Oe,0,0),T(1,De,15,7,"tr",null,B)),e&2){let t,i=c.$implicit,r=c.$index,u=d();x(r===0?0:-1),o(),k((t=u.map.get(i))==null?null:t.values())}}var ye=(()=>{class e{balances;employeeSummary;map=new Map;dates=[];rowSpan=new Map;reducedSummary=new Map;ngOnChanges(t){if(t.balances.currentValue&&(this.balances=new Map(Object.entries(t.balances.currentValue))),!!t.employeeSummary){this.map=new Map(Object.entries(this.employeeSummary)),this.rowSpan.clear(),this.reducedSummary.clear(),this.dates=Object.keys(this.employeeSummary);for(let i of this.dates)if(this.map.get(i)){this.map.get(i).length>1&&this.rowSpan.set(i,this.map.get(i).length);for(let r of this.map.get(i)){let u=this.reducedSummary.get(r.name);u||(u={receipts:0,freeHaircuts:0,salary:0,paid:0,grossRev:0,date:"",name:""}),this.reducedSummary.set(r.name,{date:"",name:r.name,receipts:u.receipts+r.receipts,grossRev:u.grossRev+r.grossRev,freeHaircuts:u.freeHaircuts+r.freeHaircuts,salary:u.salary+r.salary,paid:u.paid+r.paid})}}}}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=_({type:e,selectors:[["app-summary-employees"]],inputs:{balances:"balances",employeeSummary:"employeeSummary"},standalone:!0,features:[j,S],decls:36,vars:22,consts:[[1,"container","is-max-tablet"],[1,"is-flex","is-justify-content-center"],[1,"table","is-narrow","is-striped","is-bordered","has-text-centered","is-size-7-mobile","my-5","ml-4","pl-4"],[1,"table-container"],[1,"table","is-striped","is-bordered","is-narrow-mobile","has-text-centered","is-size-7-mobile","my-2"],[1,"is-primary"],[1,"has-text-centered"],[1,"is-info"],[1,"left-border"],[1,"has-text-centered","left-border"],[1,"is-vcentered",3,"rowSpan"]],template:function(i,r){i&1&&(n(0,"div",0)(1,"div",1)(2,"table",2)(3,"tbody"),T(4,Re,14,7,"tr",null,B,!1,Pe,4,3,"tr"),a()()(),n(7,"div",1)(8,"div",3)(9,"table",4)(10,"thead")(11,"tr",5)(12,"th",6),l(13),p(14,"translate"),a(),n(15,"th",6),l(16),p(17,"translate"),a(),n(18,"th",6),l(19),p(20,"translate"),a(),n(21,"th",6),l(22),p(23,"translate"),a(),n(24,"th",6),l(25),p(26,"translate"),a(),n(27,"th",6),l(28),p(29,"translate"),a(),n(30,"th",6),l(31),p(32,"translate"),a()()(),n(33,"tbody"),T(34,He,3,1,null,null,B),a()()()()()),i&2&&(o(4),k(r.reducedSummary.values()),o(9),s(m(14,8,"Date")),o(3),s(m(17,10,"Name")),o(3),s(m(20,12,"Receipts")),o(3),s(m(23,14,"Gross")),o(3),s(m(26,16,"Free Cuts")),o(3),s(m(29,18,"Salary")),o(3),s(m(32,20,"Paid")),o(3),k(r.dates))},dependencies:[C,E,re],styles:[".left-border[_ngcontent-%COMP%]{border-left:5px solid #20c200!important;border-width:10px}.table-container[_ngcontent-%COMP%]{position:relative;max-height:350px;overflow-y:auto}table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]{position:sticky;z-index:2}thead[_ngcontent-%COMP%]{top:0}tfoot[_ngcontent-%COMP%]{bottom:0}"]})}return e})();function qe(e,c){if(e&1&&h(0,"app-summary-table",5),e&2){let t=d(2);f("summary",t.summary.summary)}}function ze(e,c){if(e&1&&(v(0,qe,1,1,"app-summary-table",5),h(1,"app-summary-employees",4)),e&2){let t=d();x(t.authService.getAccessLevel()>1?0:-1),o(),f("employeeSummary",t.summary.employees)("balances",t.summary.summary.balances)}}var Se=(()=>{class e{httpService;authService;constructor(t,i){this.httpService=t,this.authService=i}summary;error=ie(void 0);requestFlag=!1;onDateSelected(t){t!=""&&(setTimeout(()=>this.requestFlag=!0),this.httpService.getSummary(t).subscribe({next:i=>{i&&(this.summary=i)},error:i=>{this.error.set(i),this.requestFlag=!1},complete:()=>{this.error.set(void 0),this.requestFlag=!1}}))}static \u0275fac=function(i){return new(i||e)(g(z),g(b))};static \u0275cmp=_({type:e,selectors:[["app-summary"]],standalone:!0,features:[S],decls:7,vars:8,consts:[[3,"dateMonthSelected","label"],[1,"is-flex","is-justify-content-center","my-1","loading"],[1,"is-size-7"],[3,"error"],[3,"employeeSummary","balances"],[3,"summary"]],template:function(i,r){i&1&&(n(0,"app-date-month",0),y("dateMonthSelected",function($){return r.onDateSelected($)}),a(),n(1,"div",1)(2,"p",2),l(3),p(4,"translate"),a(),h(5,"app-error",3),a(),v(6,ze,2,3,"app-summary-employees",4)),i&2&&(f("label","Summary for "+r.authService.getUsername()),o(2),w("is-hidden",!r.requestFlag),o(),M("",m(4,6,"Loading")," ..."),o(2),f("error",r.error()),o(),x(r.summary?6:-1))},dependencies:[fe,_e,ye,q,C,E],styles:[".loading[_ngcontent-%COMP%]{min-height:25px}"]})}return e})();var Ce=()=>({exact:!0}),ge=(()=>{class e{authService;constructor(t){this.authService=t}static \u0275fac=function(i){return new(i||e)(g(b))};static \u0275cmp=_({type:e,selectors:[["app-money"]],standalone:!0,features:[S],decls:23,vars:20,consts:[[1,"tabs","is-boxed","mt-3"],["routerLinkActive","is-active",3,"routerLinkActiveOptions"],["routerLink","./"],["routerLink","logs"],["routerLinkActive","is-active"],["routerLink","expenses"],["routerLink","6thcuts"]],template:function(i,r){i&1&&(n(0,"div",0)(1,"ul")(2,"li",1)(3,"a",2)(4,"span"),l(5),p(6,"translate"),a()()(),n(7,"li",1)(8,"a",3)(9,"span"),l(10),p(11,"translate"),a()()(),n(12,"li",4)(13,"a",5)(14,"span"),l(15),p(16,"translate"),a()()(),n(17,"li",4)(18,"a",6)(19,"span"),l(20),p(21,"translate"),a()()()()(),h(22,"router-outlet")),i&2&&(o(2),f("routerLinkActiveOptions",J(18,Ce)),o(3),s(m(6,10,"Money")),o(2),f("routerLinkActiveOptions",J(19,Ce)),o(3),s(m(11,12,"Logs")),o(2),w("is-hidden",r.authService.getAccessLevel()<3),o(3),s(m(16,14,"Expenses")),o(2),w("is-hidden",r.authService.getAccessLevel()<3),o(3),s(m(21,16,"6th haircuts")))},dependencies:[ue,N,D,H,C,E],styles:[".sticky-header[_ngcontent-%COMP%]{position:sticky;top:0;background-color:#f5f5f5;z-index:1}"]})}return e})();var Ue=["username"],Qe=["password"];function Ge(e,c){e&1&&(n(0,"p",3),l(1,"Loading ..."),a())}var be=(()=>{class e{httpService;authService;userInput;passInput;errorResponse;requestFlag=!1;constructor(t,i){this.httpService=t,this.authService=i}login(){let t=(this.userInput?.nativeElement).value,i=(this.passInput?.nativeElement).value;this.requestFlag=!0,this.authService.login(t,i).subscribe({error:r=>{r.status===406?this.errorResponse={error:!0,message:"Invalid username or password"}:r.status===423?this.errorResponse={error:!0,message:"You're temporarily locked out. Try again in 5 minutes"}:this.errorResponse=r,this.requestFlag=!1},complete:()=>{this.requestFlag=!1,this.errorResponse=void 0}})}static \u0275fac=function(i){return new(i||e)(g(z),g(b))};static \u0275cmp=_({type:e,selectors:[["app-login"]],viewQuery:function(i,r){if(i&1&&(Q(Ue,5),Q(Qe,5)),i&2){let u;G(u=K())&&(r.userInput=u.first),G(u=K())&&(r.passInput=u.first)}},standalone:!0,features:[S],decls:23,vars:2,consts:[["username",""],["password",""],[1,"is-flex","is-justify-content-center","mt-1"],[2,"position","absolute"],[1,"hero","is-light","is-fullheight"],[1,"m-5"],[1,"container"],[1,"columns","is-centered"],[1,"column","is-5-tablet","is-4-desktop","is-3-widescreen"],["action","",1,"box"],[1,"field"],["for","",1,"label"],["type","text",1,"input"],["type","password",1,"input"],[3,"error"],["type","button",1,"button","is-info",3,"click"]],template:function(i,r){if(i&1){let u=P();n(0,"div",2),v(1,Ge,2,0,"p",3),a(),n(2,"section",4)(3,"div",5)(4,"div",6)(5,"div",7)(6,"div",8)(7,"form",9)(8,"div",10)(9,"label",11),l(10,"Username"),a(),h(11,"input",12,0),a(),n(13,"div",10)(14,"label",11),l(15,"Password"),a(),h(16,"input",13,1),a(),n(18,"div",10),h(19,"app-error",14),a(),n(20,"div",10)(21,"button",15),y("click",function(){return A(u),L(r.login())}),l(22," Login "),a()()()()()()()()}i&2&&(o(),x(r.requestFlag?1:-1),o(18),f("error",r.errorResponse))},dependencies:[q]})}return e})();var I=(e,c)=>{let t=R(ce);return R(b).isAuthenticated()?!0:(t.navigate(["/login"]),!1)};var Ee=[{path:"summary",canActivate:[I],component:Se},{path:"transactions",canActivate:[I],loadComponent:()=>import("./chunk-4GYNKXPE.js").then(e=>e.TransactionsComponent)},{path:"money",canActivate:[I],component:ge,children:[{path:"",canActivate:[I],loadComponent:()=>import("./chunk-7UXOLDAL.js").then(e=>e.MoneyManagementComponent)},{path:"logs",canActivate:[I],loadComponent:()=>import("./chunk-LP77GRKZ.js").then(e=>e.LogsComponent)},{path:"expenses",canActivate:[I],loadComponent:()=>import("./chunk-H642QBH3.js").then(e=>e.ExpensesComponent)},{path:"6thcuts",canActivate:[I],loadComponent:()=>import("./chunk-6UIKKRB5.js").then(e=>e.SixthCutsComponent)}]},{path:"schedule",canActivate:[I],loadComponent:()=>import("./chunk-GG4PBVAC.js").then(e=>e.ScheduleComponent)},{path:"users",canActivate:[I],loadComponent:()=>import("./chunk-M435JPTS.js").then(e=>e.UsersComponent)},{path:"login",component:be},{path:"**",redirectTo:"/summary"}];var Ie=(()=>{class e{constructor(){}intercept(t,i){let r=R(b),u=t.clone({setHeaders:{Authorization:`Bearer ${r.getToken()}`,"Content-Type":"application/json"}});return i.handle(u).pipe(X({error:$=>{$.status===401&&r.logout()}}))}static \u0275fac=function(i){return new(i||e)};static \u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Ke(e,c){if(e&1){let t=P();n(0,"a",11),y("click",function(){A(t);let r=d(3);return L(r.onBurgerClick())}),l(1),p(2,"translate"),a()}if(e&2){let t=d().$implicit;f("routerLink",t.url),o(),M(" ",m(2,2,t.text)," ")}}function Je(e,c){if(e&1&&v(0,Ke,3,4,"a",10),e&2){let t=c.$implicit,i=d(2);x(t.access_level<=i.authService.getAccessLevel()?0:-1)}}function Ye(e,c){if(e&1&&T(0,Je,1,1,null,null,ne),e&2){let t=d();k(t.links)}}function Ze(e,c){if(e&1){let t=P();n(0,"button",12),y("click",function(){A(t);let r=d();return L(r.logout())}),n(1,"span"),l(2,"Exit"),a(),n(3,"span",13),h(4,"i",14),a()(),n(5,"a",15),y("click",function(){A(t);let r=d();return L(r.logout())}),l(6,"Logout"),a()}}var Te=(()=>{class e{authService;translate;menuActive=!1;language="EN";links=[{text:"Summary",url:"summary",access_level:1},{text:"Transactions",url:"transactions",access_level:1},{text:"Money",url:"money",access_level:1},{text:"Schedule",url:"schedule",access_level:1},{text:"Users",url:"users",access_level:3}];constructor(t,i){this.authService=t,this.translate=i}logout(){this.authService.logout()}onBurgerClick(){this.menuActive=!this.menuActive}changeLang(){this.translate.use(this.language.toLowerCase()),this.language==="RU"?this.language="EN":this.language="RU"}static \u0275fac=function(i){return new(i||e)(g(b),g(V))};static \u0275cmp=_({type:e,selectors:[["app-navbar"]],standalone:!0,features:[S],decls:17,vars:5,consts:[["role","navigation",1,"navbar","is-info"],[1,"navbar-brand"],[1,"navbar-item","has-text-weight-bold","has-text-light"],["role","button","aria-label","menu","aria-expanded","true","data-target","mainMenu",1,"navbar-burger",3,"click"],["aria-hidden","true"],["id","mainMenu",1,"navbar-menu",3,"click"],[1,"navbar-start"],[1,"navbar-end"],[1,"buttons"],[1,"button","is-small","mx-0","is-info","has-text-white","is-hidden-touch",3,"click"],["routerLinkActive","'has-background-light has-text-dark'",1,"navbar-item","has-text-light",3,"routerLink"],["routerLinkActive","'has-background-light has-text-dark'",1,"navbar-item","has-text-light",3,"click","routerLink"],["alt","Log out",1,"button","is-small","mx-2","is-info","has-text-white","is-hidden-touch",3,"click"],[1,"icon","is-small"],[1,"fas","fa-sign-out-alt"],["alt","Log out",1,"navbar-item","has-text-light","is-hidden-desktop",3,"click"]],template:function(i,r){i&1&&(n(0,"nav",0)(1,"div",1)(2,"span",2),l(3,"AKIO"),a(),n(4,"a",3),y("click",function(){return r.onBurgerClick()}),h(5,"span",4)(6,"span",4)(7,"span",4)(8,"span",4),a()(),n(9,"div",5),y("click",function(){return r.menuActive=!1}),n(10,"div",6),v(11,Ye,2,0),a(),n(12,"div",7)(13,"div",8)(14,"button",9),y("click",function(){return r.changeLang()}),l(15),a(),v(16,Ze,7,0),a()()()()),i&2&&(o(9),w("is-active",r.menuActive),o(2),x(r.authService.isAuthenticated()?11:-1),o(4),s(r.language),o(),x(r.authService.isAuthenticated()?16:-1))},dependencies:[D,H,C,E],styles:["@media (max-width: 1024px){.navbar-menu.is-active[_ngcontent-%COMP%]{position:fixed;width:100%}}"]})}return e})();var U=class{http;prefix;suffix;constructor(c,t="/assets/i18n/",i=".json"){this.http=c,this.prefix=t,this.suffix=i}getTranslation(c){return this.http.get(`${this.prefix}${c}${this.suffix}`)}};function ke(e){return new U(e,`${he.assetPath}/assets/i18n/`,".json")}var we=(()=>{class e{translate;title="Akio";constructor(t){this.translate=t,t.addLangs(["en","ru"]),this.translate.setDefaultLang("ru")}static \u0275fac=function(i){return new(i||e)(g(V))};static \u0275cmp=_({type:e,selectors:[["app-root"]],standalone:!0,features:[S],decls:4,vars:0,consts:[[1,"mt-3"]],template:function(i,r){i&1&&(h(0,"app-navbar")(1,"router-outlet"),n(2,"div",0),l(3,"\xA0"),a())},dependencies:[N,Te,oe,C]})}return e})();var Me={providers:[ae({eventCoalescing:!0}),de(Ee),Z(),Z(pe()),{provide:se,useClass:Ie,multi:!0},te(C.forRoot({loader:{provide:ve,useFactory:ke,deps:[le]}}))]};me(we,Me).catch(e=>console.error(e));
