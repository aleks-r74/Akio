import{a as ue}from"./chunk-TX7EHRFM.js";import{a as se,b as P,c as me,d as H,e as O,f as pe,g as ce,h as E}from"./chunk-75LVMQMG.js";import{a as fe}from"./chunk-UBJZUW5L.js";import{$ as X,$b as q,Ca as ee,Ha as f,J as Z,Ja as x,Ka as D,La as v,M as W,Ma as L,Na as te,Oa as I,Pa as k,Qa as n,Ra as a,Rb as ae,S as B,Sa as h,Va as R,W as _,Wa as y,Wb as re,Xa as u,Xb as oe,Yb as J,Zb as le,_b as de,ac as b,bb as Q,bc as C,cb as G,cc as V,da as N,db as K,dc as U,ea as M,eb as l,fa as A,fb as s,gb as w,jb as S,kb as ie,nb as p,ob as c,ua as o,va as g,wb as ne}from"./chunk-NMAALOYJ.js";function Ie(e,m){if(e&1&&(n(0,"td",5),l(1),a(),n(2,"td",5),l(3),a()),e&2){let t=u().$implicit,i=u();o(),s(t),o(2),s(i.expenses==null?null:i.expenses.get(t))}}function ke(e,m){if(e&1&&(n(0,"td"),l(1),a(),n(2,"td"),l(3),a()),e&2){let t=u().$implicit,i=u();o(),s(t),o(2),s(i.expenses==null?null:i.expenses.get(t))}}function we(e,m){if(e&1&&(n(0,"tr"),f(1,Ie,4,2)(2,ke,4,2),a()),e&2){let t=m.$index,i=m.$count;o(),v(t===i-1?1:2)}}var ve=(()=>{class e{summary;expenses;showSpendings=!1;ngOnChanges(t){if(t.summary&&this.summary?.expenses){this.expenses=new Map(Object.entries(this.summary.expenses));let i=0;for(let r of this.expenses?.values())i+=r;this.expenses.set("Total",i)}}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=_({type:e,selectors:[["app-summary-table"]],inputs:{summary:"summary"},standalone:!0,features:[N,S],decls:61,vars:32,consts:[[1,"columns","is-flex","is-justify-content-center","is-size-7"],[1,"column","is-narrow","is-flex","is-justify-content-center"],[1,"table","m-0"],[1,"has-text-centered"],[3,"click"],[1,"has-text-weight-bold"],[1,"table"],[1,"has-text-danger","has-text-centered"],[1,"field","is-grouped","is-grouped-multiline"],[1,"control"],[1,"tags","has-addons"],[1,"tag","is-info","has-text-weight-bold"],[1,"tag","is-light","has-text-weight-bold"],[3,"close","active"],[1,"table","is-size-7"],["colspan","2",1,"has-text-centered"]],template:function(i,r){i&1&&(n(0,"div",0)(1,"div",1)(2,"table",2)(3,"tr")(4,"th"),l(5),p(6,"translate"),a(),n(7,"td",3),l(8),a()(),n(9,"tr",4),y("click",function(){return r.showSpendings=!0}),n(10,"th"),l(11),p(12,"translate"),a(),n(13,"td",3)(14,"a",5),l(15),a()()()()(),n(16,"div",1)(17,"table",6)(18,"tr")(19,"th"),l(20),p(21,"translate"),a(),n(22,"td",3),l(23),a()(),n(24,"tr")(25,"th"),l(26),p(27,"translate"),a(),n(28,"td",3),l(29),a()()()(),n(30,"div",1)(31,"table",6)(32,"tr")(33,"th"),l(34),p(35,"translate"),a(),n(36,"td",7),l(37),a()(),n(38,"tr")(39,"th"),l(40),p(41,"translate"),a(),n(42,"td",3),l(43),a()()()()(),n(44,"div",0)(45,"div",8)(46,"div",9)(47,"div",10)(48,"span",11),l(49),p(50,"translate"),a(),n(51,"span",12),l(52),a()()()()(),n(53,"app-modal",13),y("close",function(){return r.showSpendings=!1}),n(54,"table",14)(55,"tr")(56,"th",15),l(57),p(58,"translate"),a()(),I(59,we,3,1,"tr",null,L),a()()),i&2&&(o(5),s(c(6,16,"Total revenue")),o(3),s(r.summary==null?null:r.summary.totalRevenue),o(3),s(c(12,18,"Total spendings")),o(4),s(r.expenses==null?null:r.expenses.get("Total")),o(5),s(c(21,20,"Total receipts")),o(3),s(r.summary==null?null:r.summary.totalReceipts),o(3),s(c(27,22,"Free haircuts")),o(3),s(r.summary==null?null:r.summary.freeHaircuts),o(5),w("",c(35,24,"Not assigned receipts")," "),o(3),s(r.summary==null?null:r.summary.notAssignedTransactions),o(3),w("",c(41,26,"Cash")," "),o(3),s(r.summary==null?null:r.summary.totalCash),o(6),s(c(50,28,"Net revenue")),o(3),s(r.summary==null?null:r.summary.netRevenue),o(),x("active",r.showSpendings),o(4),s(c(58,30,"Total spendings")),o(2),k(r.expenses==null?null:r.expenses.keys()))},dependencies:[C,b,fe]})}return e})();function Fe(e,m){e&1&&(n(0,"thead")(1,"tr")(2,"th",4),l(3),p(4,"translate"),a(),n(5,"th",4),l(6),p(7,"translate"),a(),n(8,"th",4),l(9),p(10,"translate"),a(),n(11,"th",4),l(12),p(13,"translate"),a(),n(14,"th",4),l(15),p(16,"translate"),a(),n(17,"th",4),l(18),p(19,"translate"),a()()()),e&2&&(o(3),s(c(4,6,"Name")),o(3),s(c(7,8,"Receipts")),o(3),s(c(10,10,"Gross")),o(3),s(c(13,12,"Free Cuts")),o(3),s(c(16,14,"Salary")),o(3),s(c(19,16,"Paid")))}function Me(e,m){if(e&1&&(f(0,Fe,20,18,"thead"),n(1,"tr")(2,"td"),l(3),a(),n(4,"td"),l(5),a(),n(6,"td"),l(7),a(),n(8,"td"),l(9),a(),n(10,"td"),l(11),a(),n(12,"td"),l(13),a()()),e&2){let t=m.$implicit,i=m.$index;v(i===0?0:-1),o(3),s(t.name),o(2),s(t.receipts),o(2),s(t.grossRev),o(2),s(t.freeHaircuts),o(2),s(t.salary),o(2),s(t.paid)}}function Ae(e,m){e&1&&(n(0,"tr")(1,"td"),l(2),p(3,"translate"),a()()),e&2&&(o(2),s(c(3,1,"Users summary not available")))}function Le(e,m){e&1&&(n(0,"thead")(1,"tr")(2,"th",4),l(3),p(4,"translate"),a(),n(5,"th",4),l(6),p(7,"translate"),a(),n(8,"th",4),l(9),p(10,"translate"),a(),n(11,"th",4),l(12),p(13,"translate"),a(),n(14,"th",4),l(15),p(16,"translate"),a(),n(17,"th",4),l(18),p(19,"translate"),a(),n(20,"th",4),l(21),p(22,"translate"),a()()()),e&2&&(o(3),s(c(4,7,"Date")),o(3),s(c(7,9,"Name")),o(3),s(c(10,11,"Receipts")),o(3),s(c(13,13,"Gross")),o(3),s(c(16,15,"Free Cuts")),o(3),s(c(19,17,"Salary")),o(3),s(c(22,19,"Paid")))}function Be(e,m){if(e&1&&(n(0,"td",5),l(1),a()),e&2){let t=u(2).$implicit,i=u().$implicit,r=u();x("rowSpan",r.rowSpan.get(i)),o(),s(t.date)}}function Re(e,m){if(e&1&&f(0,Be,2,2,"td",5),e&2){let t=u().$index;v(t==0?0:-1)}}function $e(e,m){if(e&1&&(n(0,"td"),l(1),a()),e&2){let t=u().$implicit;o(),s(t.date)}}function je(e,m){if(e&1&&(n(0,"tr"),f(1,Re,1,1)(2,$e,2,1,"td"),n(3,"td"),l(4),a(),n(5,"td"),l(6),a(),n(7,"td"),l(8),a(),n(9,"td"),l(10),a(),n(11,"td"),l(12),a(),n(13,"td"),l(14),a()()),e&2){let t=m.$implicit,i=u().$implicit,r=u();o(),v(r.rowSpan.get(i)?1:2),o(3),s(t.name),o(2),s(t.receipts),o(2),s(t.grossRev),o(2),s(t.freeHaircuts),o(2),s(t.salary),o(2),s(t.paid)}}function Ne(e,m){if(e&1&&(f(0,Le,23,21,"thead"),I(1,je,15,7,"tr",null,L)),e&2){let t,i=m.$implicit,r=m.$index,d=u();v(r===0?0:-1),o(),k((t=d.map.get(i))==null?null:t.values())}}var xe=(()=>{class e{employeeSummary;map=new Map;dates=[];rowSpan=new Map;summary=new Map;ngOnChanges(t){if(t.employeeSummary){this.map=new Map(Object.entries(this.employeeSummary)),this.rowSpan.clear(),this.summary.clear(),this.dates=Object.keys(this.employeeSummary);for(let i of this.dates)if(this.map.get(i)){this.map.get(i).length>1&&this.rowSpan.set(i,this.map.get(i).length);for(let r of this.map.get(i)){let d=this.summary.get(r.name);d||(d={receipts:0,freeHaircuts:0,salary:0,paid:0,grossRev:0,date:"",name:""}),this.summary.set(r.name,{date:"",name:r.name,receipts:d.receipts+r.receipts,grossRev:d.grossRev+r.grossRev,freeHaircuts:d.freeHaircuts+r.freeHaircuts,salary:d.salary+r.salary,paid:d.paid+r.paid})}}}}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=_({type:e,selectors:[["app-summary-employees"]],inputs:{employeeSummary:"employeeSummary"},standalone:!0,features:[N,S],decls:9,vars:1,consts:[[1,"columns","is-flex","is-justify-content-center","is-size-7","my-3"],[1,"column","is-narrow","is-flex-direction-column","is-justify-content-center"],[1,"table","has-text-centered","is-bordered","is-fullwidth"],[1,"table","has-text-centered","is-bordered"],[1,"has-text-centered"],[1,"is-vcentered",3,"rowSpan"]],template:function(i,r){i&1&&(n(0,"div",0)(1,"div",1)(2,"table",2),I(3,Me,14,7,"tr",null,L,!1,Ae,4,3,"tr"),a(),n(6,"table",3),I(7,Ne,3,1,null,null,L),a()()()),i&2&&(o(3),k(r.summary.values()),o(4),k(r.dates))},dependencies:[C,b]})}return e})();function Pe(e,m){if(e&1&&h(0,"app-summary-table",5),e&2){let t=u(2);x("summary",t.summary.summary)}}function He(e,m){if(e&1&&(f(0,Pe,1,1,"app-summary-table",5),h(1,"app-summary-employees",4)),e&2){let t=u();v(t.authService.getAccessLevel()>1?0:-1),o(),x("employeeSummary",t.summary.employees)}}var he=(()=>{class e{httpService;authService;constructor(t,i){this.httpService=t,this.authService=i}summary;error=ee(void 0);requestFlag=!1;onDateSelected(t){t!=""&&(setTimeout(()=>this.requestFlag=!0),this.httpService.getSummary(t).subscribe({next:i=>{i&&(this.summary=i)},error:i=>{this.error.set(i),this.requestFlag=!1},complete:()=>{this.error.set(void 0),this.requestFlag=!1}}))}static \u0275fac=function(i){return new(i||e)(g(U),g(E))};static \u0275cmp=_({type:e,selectors:[["app-summary"]],standalone:!0,features:[S],decls:7,vars:8,consts:[[3,"dateMonthSelected","label"],[1,"is-flex","is-justify-content-center","my-1","loading"],[1,"is-size-7"],[3,"error"],[3,"employeeSummary"],[3,"summary"]],template:function(i,r){i&1&&(n(0,"app-date-month",0),y("dateMonthSelected",function(j){return r.onDateSelected(j)}),a(),n(1,"div",1)(2,"p",2),l(3),p(4,"translate"),a(),h(5,"app-error",3),a(),f(6,He,2,2,"app-summary-employees",4)),i&2&&(x("label","Summary for "+r.authService.getUsername()),o(2),D("is-hidden",!r.requestFlag),o(),w("",c(4,6,"Loading")," ..."),o(2),x("error",r.error()),o(),v(r.summary?6:-1))},dependencies:[ue,ve,xe,V,C,b],styles:[".loading[_ngcontent-%COMP%]{min-height:25px}"]})}return e})();var Oe=()=>({exact:!0});function qe(e,m){e&1&&(n(0,"div",0)(1,"ul")(2,"li",1)(3,"a",2)(4,"span"),l(5),p(6,"translate"),a()()(),n(7,"li",3)(8,"a",4)(9,"span"),l(10),p(11,"translate"),a()()(),n(12,"li",3)(13,"a",5)(14,"span"),l(15),p(16,"translate"),a()()()()()),e&2&&(o(2),x("routerLinkActiveOptions",ie(10,Oe)),o(3),s(c(6,4,"Money")),o(5),s(c(11,6,"Expenses")),o(5),s(c(16,8,"6th haircuts")))}var _e=(()=>{class e{authService;constructor(t){this.authService=t}static \u0275fac=function(i){return new(i||e)(g(E))};static \u0275cmp=_({type:e,selectors:[["app-money"]],standalone:!0,features:[S],decls:2,vars:1,consts:[[1,"tabs","is-boxed","mt-3"],["routerLinkActive","is-active",3,"routerLinkActiveOptions"],["routerLink","./"],["routerLinkActive","is-active"],["routerLink","expenses"],["routerLink","6thcuts"]],template:function(i,r){i&1&&(f(0,qe,17,11,"div",0),h(1,"router-outlet")),i&2&&v(r.authService.getAccessLevel()==3?0:-1)},dependencies:[ce,P,H,O,C,b],styles:[".sticky-header[_ngcontent-%COMP%]{position:sticky;top:0;background-color:#f5f5f5;z-index:1}"]})}return e})();var Ve=["username"],Ue=["password"];function ze(e,m){e&1&&(n(0,"p",3),l(1,"Loading ..."),a())}var ye=(()=>{class e{httpService;authService;userInput;passInput;errorResponse;requestFlag=!1;constructor(t,i){this.httpService=t,this.authService=i}login(){let t=(this.userInput?.nativeElement).value,i=(this.passInput?.nativeElement).value;this.requestFlag=!0,this.authService.login(t,i).subscribe({error:r=>{r.status===406?this.errorResponse={error:!0,message:"Invalid username or password"}:r.status===423?this.errorResponse={error:!0,message:"You're temporarily locked out. Try again in 5 minutes"}:this.errorResponse=r,this.requestFlag=!1},complete:()=>{this.requestFlag=!1,this.errorResponse=void 0}})}static \u0275fac=function(i){return new(i||e)(g(U),g(E))};static \u0275cmp=_({type:e,selectors:[["app-login"]],viewQuery:function(i,r){if(i&1&&(Q(Ve,5),Q(Ue,5)),i&2){let d;G(d=K())&&(r.userInput=d.first),G(d=K())&&(r.passInput=d.first)}},standalone:!0,features:[S],decls:23,vars:2,consts:[["username",""],["password",""],[1,"is-flex","is-justify-content-center","mt-1"],[2,"position","absolute"],[1,"hero","is-light","is-fullheight"],[1,"m-5"],[1,"container"],[1,"columns","is-centered"],[1,"column","is-5-tablet","is-4-desktop","is-3-widescreen"],["action","",1,"box"],[1,"field"],["for","",1,"label"],["type","text",1,"input"],["type","password",1,"input"],[3,"error"],["type","button",1,"button","is-info",3,"click"]],template:function(i,r){if(i&1){let d=R();n(0,"div",2),f(1,ze,2,0,"p",3),a(),n(2,"section",4)(3,"div",5)(4,"div",6)(5,"div",7)(6,"div",8)(7,"form",9)(8,"div",10)(9,"label",11),l(10,"Username"),a(),h(11,"input",12,0),a(),n(13,"div",10)(14,"label",11),l(15,"Password"),a(),h(16,"input",13,1),a(),n(18,"div",10),h(19,"app-error",14),a(),n(20,"div",10)(21,"button",15),y("click",function(){return M(d),A(r.login())}),l(22," Login "),a()()()()()()()()}i&2&&(o(),v(r.requestFlag?1:-1),o(18),x("error",r.errorResponse))},dependencies:[V]})}return e})();var T=(e,m)=>{let t=B(me);return B(E).isAuthenticated()?!0:(t.navigate(["/login"]),!1)};var Se=[{path:"summary",canActivate:[T],component:he},{path:"transactions",canActivate:[T],loadComponent:()=>import("./chunk-C7XEZAQG.js").then(e=>e.TransactionsComponent)},{path:"money",canActivate:[T],component:_e,children:[{path:"",canActivate:[T],loadComponent:()=>import("./chunk-GKTSZJBP.js").then(e=>e.MoneyManagementComponent)},{path:"expenses",canActivate:[T],loadComponent:()=>import("./chunk-KVXYZATM.js").then(e=>e.ExpensesComponent)},{path:"6thcuts",canActivate:[T],loadComponent:()=>import("./chunk-NYWFCE6E.js").then(e=>e.SixthCutsComponent)}]},{path:"schedule",canActivate:[T],loadComponent:()=>import("./chunk-PPKNS7OD.js").then(e=>e.ScheduleComponent)},{path:"users",canActivate:[T],loadComponent:()=>import("./chunk-NNY5BI4W.js").then(e=>e.UsersComponent)},{path:"login",component:ye},{path:"**",redirectTo:"/summary"}];var Ce=(()=>{class e{constructor(){}intercept(t,i){let r=B(E),d=t.clone({setHeaders:{Authorization:`Bearer ${r.getToken()}`,"Content-Type":"application/json"}});return i.handle(d).pipe(Z({error:j=>{j.status===401&&r.logout()}}))}static \u0275fac=function(i){return new(i||e)};static \u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Qe(e,m){if(e&1){let t=R();n(0,"a",11),y("click",function(){M(t);let r=u(3);return A(r.onBurgerClick())}),l(1),p(2,"translate"),a()}if(e&2){let t=u().$implicit;x("routerLink",t.url),o(),w(" ",c(2,2,t.text)," ")}}function Ge(e,m){if(e&1&&f(0,Qe,3,4,"a",10),e&2){let t=m.$implicit,i=u(2);v(t.access_level<=i.authService.getAccessLevel()?0:-1)}}function Ke(e,m){if(e&1&&I(0,Ge,1,1,null,null,te),e&2){let t=u();k(t.links)}}function Je(e,m){if(e&1){let t=R();n(0,"button",12),y("click",function(){M(t);let r=u();return A(r.logout())}),n(1,"span"),l(2,"Exit"),a(),n(3,"span",13),h(4,"i",14),a()(),n(5,"a",15),y("click",function(){M(t);let r=u();return A(r.logout())}),l(6,"Logout"),a()}}var ge=(()=>{class e{authService;translate;menuActive=!1;language="EN";links=[{text:"Summary",url:"summary",access_level:1},{text:"Transactions",url:"transactions",access_level:1},{text:"Money",url:"money",access_level:1},{text:"Schedule",url:"schedule",access_level:1},{text:"Users",url:"users",access_level:3}];constructor(t,i){this.authService=t,this.translate=i}logout(){this.authService.logout()}onBurgerClick(){this.menuActive=!this.menuActive}changeLang(){this.translate.use(this.language.toLowerCase()),this.language==="RU"?this.language="EN":this.language="RU"}static \u0275fac=function(i){return new(i||e)(g(E),g(q))};static \u0275cmp=_({type:e,selectors:[["app-navbar"]],standalone:!0,features:[S],decls:17,vars:5,consts:[["role","navigation",1,"navbar","is-info"],[1,"navbar-brand"],[1,"navbar-item","has-text-weight-bold","has-text-light"],["role","button","aria-label","menu","aria-expanded","true","data-target","mainMenu",1,"navbar-burger",3,"click"],["aria-hidden","true"],["id","mainMenu",1,"navbar-menu",3,"click"],[1,"navbar-start"],[1,"navbar-end"],[1,"buttons"],[1,"button","is-small","mx-0","is-info","has-text-white","is-hidden-touch",3,"click"],["routerLinkActive","'has-background-light has-text-dark'",1,"navbar-item","has-text-light",3,"routerLink"],["routerLinkActive","'has-background-light has-text-dark'",1,"navbar-item","has-text-light",3,"click","routerLink"],["alt","Log out",1,"button","is-small","mx-2","is-info","has-text-white","is-hidden-touch",3,"click"],[1,"icon","is-small"],[1,"fas","fa-sign-out-alt"],["alt","Log out",1,"navbar-item","has-text-light","is-hidden-desktop",3,"click"]],template:function(i,r){i&1&&(n(0,"nav",0)(1,"div",1)(2,"span",2),l(3,"AKIO"),a(),n(4,"a",3),y("click",function(){return r.onBurgerClick()}),h(5,"span",4)(6,"span",4)(7,"span",4)(8,"span",4),a()(),n(9,"div",5),y("click",function(){return r.menuActive=!1}),n(10,"div",6),f(11,Ke,2,0),a(),n(12,"div",7)(13,"div",8)(14,"button",9),y("click",function(){return r.changeLang()}),l(15),a(),f(16,Je,7,0),a()()()()),i&2&&(o(9),D("is-active",r.menuActive),o(2),v(r.authService.isAuthenticated()?11:-1),o(4),s(r.language),o(),v(r.authService.isAuthenticated()?16:-1))},dependencies:[H,O,C,b],styles:["@media (max-width: 1024px){.navbar-menu.is-active[_ngcontent-%COMP%]{position:absolute;width:100%}}"]})}return e})();var z=class{http;prefix;suffix;constructor(m,t="/assets/i18n/",i=".json"){this.http=m,this.prefix=t,this.suffix=i}getTranslation(m){return this.http.get(`${this.prefix}${m}${this.suffix}`)}};function Ee(e){return new z(e,"/assets/i18n/",".json")}var be=(()=>{class e{translate;title="Akio";constructor(t){this.translate=t,t.addLangs(["en","ru"]),this.translate.setDefaultLang("ru")}static \u0275fac=function(i){return new(i||e)(g(q))};static \u0275cmp=_({type:e,selectors:[["app-root"]],standalone:!0,features:[S],decls:4,vars:0,consts:[[1,"mt-3"]],template:function(i,r){i&1&&(h(0,"app-navbar")(1,"router-outlet"),n(2,"div",0),l(3,"\xA0"),a())},dependencies:[P,ge,ae,C]})}return e})();var Te={providers:[ne({eventCoalescing:!0}),pe(Se),J(),J(le()),{provide:oe,useClass:Ce,multi:!0},X(C.forRoot({loader:{provide:de,useFactory:Ee,deps:[re]}}))]};se(be,Te).catch(e=>console.error(e));
